{% doc %}
  @prompt
    build a offers section for me , i want something like: Available offers
    
    Enjoy ৳ 100 off on orders ৳ 1500+
    
    INSTANT100
    
    Copy. the section should be like this: import * as React from "react"
    import { motion, PanInfo } from "framer-motion"
    import { cn } from "@/lib/utils"
    
    interface Testimonial {
      id: number | string
      name: string
      avatar: string
      description: string
    }
    
    interface TestimonialCarouselProps
      extends React.HTMLAttributes<HTMLDivElement> {
      testimonials: Testimonial[]
      showArrows?: boolean
      showDots?: boolean
    }
    
    const TestimonialCarousel = React.forwardRef<
      HTMLDivElement,
      TestimonialCarouselProps
    >(
      (
        { className, testimonials, showArrows = true, showDots = true, ...props },
        ref,
      ) => {
        const [currentIndex, setCurrentIndex] = React.useState(0)
        const [exitX, setExitX] = React.useState<number>(0)
    
        const handleDragEnd = (
          event: MouseEvent | TouchEvent | PointerEvent,
          info: PanInfo,
        ) => {
          if (Math.abs(info.offset.x) > 100) {
            setExitX(info.offset.x)
            setTimeout(() => {
              setCurrentIndex((prev) => (prev + 1) % testimonials.length)
              setExitX(0)
            }, 200)
          }
        }
    
        return (
          <div
            ref={ref}
            className={cn(
              "h-72 w-full flex items-center justify-center",
              className
            )}
            {...props}
          >
            <div className="relative w-80 h-64">
              {testimonials.map((testimonial, index) => {
                const isCurrentCard = index === currentIndex
                const isPrevCard =
                  index === (currentIndex + 1) % testimonials.length
                const isNextCard =
                  index === (currentIndex + 2) % testimonials.length
    
                if (!isCurrentCard && !isPrevCard && !isNextCard) return null
    
                return (
                  <motion.div
                    key={testimonial.id}
                    className={cn(
                      "absolute w-full h-full rounded-2xl cursor-grab active:cursor-grabbing",
     
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-offers-section-{{ ai_gen_id }} {
    padding: 40px 20px;
    background-color: {{ block.settings.background_color }};
    overflow: hidden;
  }

  .ai-offers-container-{{ ai_gen_id }} {
    max-width: 1200px;
    margin: 0 auto;
  }

  .ai-offers-heading-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 32px;
    color: {{ block.settings.heading_color }};
    font-size: {{ block.settings.heading_size }}px;
  }

  .ai-offers-carousel-wrapper-{{ ai_gen_id }} {
    position: relative;
    height: 280px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-offers-carousel-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    max-width: 400px;
    height: 240px;
    margin: 0 auto;
  }

  .ai-offer-card-{{ ai_gen_id }} {
    position: absolute;
    width: 100%;
    height: 100%;
    background: {{ block.settings.card_background }};
    border-radius: {{ block.settings.card_border_radius }}px;
    padding: 32px 24px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    cursor: grab;
    user-select: none;
    transition: transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    gap: 16px;
  }

  .ai-offer-card-{{ ai_gen_id }}:active {
    cursor: grabbing;
  }

  .ai-offer-card-{{ ai_gen_id }}.current {
    z-index: 3;
    transform: translateX(0) scale(1);
    opacity: 1;
  }

  .ai-offer-card-{{ ai_gen_id }}.prev {
    z-index: 2;
    transform: translateX(-20%) scale(0.9);
    opacity: 0.5;
    pointer-events: none;
  }

  .ai-offer-card-{{ ai_gen_id }}.next {
    z-index: 1;
    transform: translateX(20%) scale(0.85);
    opacity: 0.3;
    pointer-events: none;
  }

  .ai-offer-card-{{ ai_gen_id }}.hidden {
    opacity: 0;
    pointer-events: none;
    z-index: 0;
  }

  .ai-offer-icon-{{ ai_gen_id }} {
    width: 56px;
    height: 56px;
    background: {{ block.settings.icon_background }};
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .ai-offer-icon-{{ ai_gen_id }} svg {
    width: 28px;
    height: 28px;
    stroke: {{ block.settings.icon_color }};
  }

  .ai-offer-title-{{ ai_gen_id }} {
    font-size: {{ block.settings.offer_title_size }}px;
    font-weight: 700;
    color: {{ block.settings.card_text_color }};
    margin: 0;
    line-height: 1.3;
  }

  .ai-offer-description-{{ ai_gen_id }} {
    font-size: {{ block.settings.offer_description_size }}px;
    color: {{ block.settings.card_text_color }};
    margin: 0;
    line-height: 1.5;
  }

  .ai-offer-code-wrapper-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 8px;
    background: {{ block.settings.code_background }};
    padding: 12px 20px;
    border-radius: {{ block.settings.code_border_radius }}px;
    border: 2px dashed {{ block.settings.code_border_color }};
  }

  .ai-offer-code-{{ ai_gen_id }} {
    font-size: {{ block.settings.code_size }}px;
    font-weight: 700;
    color: {{ block.settings.code_color }};
    letter-spacing: 1px;
    font-family: monospace;
  }

  .ai-offer-copy-btn-{{ ai_gen_id }} {
    background: {{ block.settings.copy_button_background }};
    color: {{ block.settings.copy_button_color }};
    border: none;
    padding: 6px 12px;
    border-radius: {{ block.settings.copy_button_border_radius }}px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
  }

  .ai-offer-copy-btn-{{ ai_gen_id }}:hover {
    background: {{ block.settings.copy_button_hover_background }};
    transform: scale(1.05);
  }

  .ai-offer-copy-btn-{{ ai_gen_id }}.copied {
    background: {{ block.settings.success_color }};
  }

  .ai-offers-dots-{{ ai_gen_id }} {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 24px;
  }

  .ai-offers-dot-{{ ai_gen_id }} {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: {{ block.settings.dot_color }};
    opacity: 0.3;
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
    padding: 0;
  }

  .ai-offers-dot-{{ ai_gen_id }}.active {
    opacity: 1;
    transform: scale(1.2);
  }

  .ai-offers-arrows-{{ ai_gen_id }} {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-top: 24px;
  }

  .ai-offers-arrow-{{ ai_gen_id }} {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: {{ block.settings.arrow_background }};
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }

  .ai-offers-arrow-{{ ai_gen_id }}:hover {
    background: {{ block.settings.arrow_hover_background }};
    transform: scale(1.1);
  }

  .ai-offers-arrow-{{ ai_gen_id }} svg {
    width: 20px;
    height: 20px;
    stroke: {{ block.settings.arrow_color }};
  }

  @media screen and (max-width: 749px) {
    .ai-offers-carousel-{{ ai_gen_id }} {
      max-width: 320px;
      height: 280px;
    }

    .ai-offer-card-{{ ai_gen_id }} {
      padding: 24px 20px;
    }

    .ai-offers-heading-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.heading_size }}px * 0.8);
    }

    .ai-offer-title-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.offer_title_size }}px * 0.9);
    }

    .ai-offer-card-{{ ai_gen_id }}.prev,
    .ai-offer-card-{{ ai_gen_id }}.next {
      display: none;
    }
  }
{% endstyle %}

<offers-carousel-{{ ai_gen_id }}
  class="ai-offers-section-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-offers-container-{{ ai_gen_id }}">
    {% if block.settings.heading != blank %}
      <h2 class="ai-offers-heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h2>
    {% endif %}

    <div class="ai-offers-carousel-wrapper-{{ ai_gen_id }}">
      <div class="ai-offers-carousel-{{ ai_gen_id }}" data-carousel>
        {% for i in (1..5) %}
          {% liquid
            assign offer_enabled_key = 'offer_' | append: i | append: '_enabled'
            assign offer_title_key = 'offer_' | append: i | append: '_title'
            assign offer_description_key = 'offer_' | append: i | append: '_description'
            assign offer_code_key = 'offer_' | append: i | append: '_code'

            assign offer_enabled = block.settings[offer_enabled_key]
            assign offer_title = block.settings[offer_title_key]
            assign offer_description = block.settings[offer_description_key]
            assign offer_code = block.settings[offer_code_key]
          %}

          {% if offer_enabled %}
            <div class="ai-offer-card-{{ ai_gen_id }}" data-offer-index="{{ forloop.index0 }}">
              <div class="ai-offer-icon-{{ ai_gen_id }}">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 14.25l6-6m4.5-3.493V21.75l-3.75-1.5-3.75 1.5-3.75-1.5-3.75 1.5V4.757c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0c1.1.128 1.907 1.077 1.907 2.185zM9.75 9h.008v.008H9.75V9zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm4.125 4.5h.008v.008h-.008V13.5zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                </svg>
              </div>

              {% if offer_title != blank %}
                <h3 class="ai-offer-title-{{ ai_gen_id }}">{{ offer_title }}</h3>
              {% endif %}

              {% if offer_description != blank %}
                <p class="ai-offer-description-{{ ai_gen_id }}">{{ offer_description }}</p>
              {% endif %}

              {% if offer_code != blank %}
                <div class="ai-offer-code-wrapper-{{ ai_gen_id }}">
                  <span class="ai-offer-code-{{ ai_gen_id }}">{{ offer_code }}</span>
                  <button
                    class="ai-offer-copy-btn-{{ ai_gen_id }}"
                    data-code="{{ offer_code }}"
                    aria-label="Copy code {{ offer_code }}"
                  >
                    Copy
                  </button>
                </div>
              {% endif %}
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    {% if block.settings.show_dots %}
      <div class="ai-offers-dots-{{ ai_gen_id }}" data-dots></div>
    {% endif %}

    {% if block.settings.show_arrows %}
      <div class="ai-offers-arrows-{{ ai_gen_id }}">
        <button class="ai-offers-arrow-{{ ai_gen_id }}" data-prev aria-label="Previous offer">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
          </svg>
        </button>
        <button class="ai-offers-arrow-{{ ai_gen_id }}" data-next aria-label="Next offer">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
          </svg>
        </button>
      </div>
    {% endif %}
  </div>
</offers-carousel-{{ ai_gen_id }}>

<script>
  (function() {
    class OffersCarousel{{ai_gen_id}} extends HTMLElement {
      constructor() {
        super();
        this.currentIndex = 0;
        this.startX = 0;
        this.isDragging = false;
      }

      connectedCallback() {
        this.carousel = this.querySelector('[data-carousel]');
        this.cards = Array.from(this.querySelectorAll('.ai-offer-card-{{ ai_gen_id }}'));
        this.dotsContainer = this.querySelector('[data-dots]');
        this.prevBtn = this.querySelector('[data-prev]');
        this.nextBtn = this.querySelector('[data-next]');

        if (this.cards.length === 0) return;

        this.setupCards();
        this.setupDots();
        this.setupEventListeners();
        this.updateCarousel();
      }

      setupCards() {
        this.cards.forEach((card, index) => {
          card.addEventListener('mousedown', this.handleDragStart.bind(this));
          card.addEventListener('touchstart', this.handleDragStart.bind(this));
        });
      }

      setupDots() {
        if (!this.dotsContainer) return;

        this.cards.forEach((card, index) => {
          const dot = document.createElement('button');
          dot.className = 'ai-offers-dot-{{ ai_gen_id }}';
          dot.setAttribute('aria-label', 'Go to offer ' + (index + 1));
          dot.addEventListener('click', () => {
            this.currentIndex = index;
            this.updateCarousel();
          });
          this.dotsContainer.appendChild(dot);
        });
      }

      setupEventListeners() {
        if (this.prevBtn) {
          this.prevBtn.addEventListener('click', () => this.navigate(-1));
        }

        if (this.nextBtn) {
          this.nextBtn.addEventListener('click', () => this.navigate(1));
        }

        document.addEventListener('mousemove', this.handleDragMove.bind(this));
        document.addEventListener('touchmove', this.handleDragMove.bind(this));
        document.addEventListener('mouseup', this.handleDragEnd.bind(this));
        document.addEventListener('touchend', this.handleDragEnd.bind(this));

        const copyButtons = this.querySelectorAll('.ai-offer-copy-btn-{{ ai_gen_id }}');
        copyButtons.forEach(btn => {
          btn.addEventListener('click', this.handleCopy.bind(this));
        });
      }

      handleDragStart(e) {
        this.isDragging = true;
        this.startX = e.type.includes('mouse') ? e.pageX : e.touches[0].pageX;
      }

      handleDragMove(e) {
        if (!this.isDragging) return;
        e.preventDefault();
      }

      handleDragEnd(e) {
        if (!this.isDragging) return;

        const endX = e.type.includes('mouse') ? e.pageX : e.changedTouches[0].pageX;
        const diff = this.startX - endX;

        if (Math.abs(diff) > 50) {
          this.navigate(diff > 0 ? 1 : -1);
        }

        this.isDragging = false;
      }

      navigate(direction) {
        this.currentIndex = (this.currentIndex + direction + this.cards.length) % this.cards.length;
        this.updateCarousel();
      }

      updateCarousel() {
        this.cards.forEach((card, index) => {
          card.classList.remove('current', 'prev', 'next', 'hidden');

          if (index === this.currentIndex) {
            card.classList.add('current');
          } else if (index === (this.currentIndex - 1 + this.cards.length) % this.cards.length) {
            card.classList.add('prev');
          } else if (index === (this.currentIndex + 1) % this.cards.length) {
            card.classList.add('next');
          } else {
            card.classList.add('hidden');
          }
        });

        if (this.dotsContainer) {
          const dots = this.dotsContainer.querySelectorAll('.ai-offers-dot-{{ ai_gen_id }}');
          dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === this.currentIndex);
          });
        }
      }

      handleCopy(e) {
        const button = e.currentTarget;
        const code = button.getAttribute('data-code');

        navigator.clipboard.writeText(code).then(() => {
          const originalText = button.textContent;
          button.textContent = 'Copied!';
          button.classList.add('copied');

          setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('copied');
          }, 2000);
        });
      }
    }

    customElements.define('offers-carousel-{{ ai_gen_id }}', OffersCarousel{{ai_gen_id}});
  })();
</script>

{% schema %}
{
  "name": "Available offers",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "General"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "Heading",
      "default": "Available offers"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Heading size",
      "default": 32
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#f9fafb"
    },
    {
      "type": "header",
      "content": "Card style"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_text_color",
      "label": "Card text color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "min": 0,
      "max": 40,
      "step": 4,
      "unit": "px",
      "label": "Card border radius",
      "default": 16
    },
    {
      "type": "range",
      "id": "offer_title_size",
      "min": 16,
      "max": 36,
      "step": 2,
      "unit": "px",
      "label": "Title size",
      "default": 22
    },
    {
      "type": "range",
      "id": "offer_description_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Description size",
      "default": 15
    },
    {
      "type": "header",
      "content": "Icon style"
    },
    {
      "type": "color",
      "id": "icon_background",
      "label": "Icon background",
      "default": "#f3f4f6"
    },
    {
      "type": "color",
      "id": "icon_color",
      "label": "Icon color",
      "default": "#6366f1"
    },
    {
      "type": "header",
      "content": "Code style"
    },
    {
      "type": "color",
      "id": "code_background",
      "label": "Code background",
      "default": "#fef3c7"
    },
    {
      "type": "color",
      "id": "code_border_color",
      "label": "Code border color",
      "default": "#fbbf24"
    },
    {
      "type": "color",
      "id": "code_color",
      "label": "Code text color",
      "default": "#92400e"
    },
    {
      "type": "range",
      "id": "code_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Code size",
      "default": 16
    },
    {
      "type": "range",
      "id": "code_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Code border radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Copy button"
    },
    {
      "type": "color",
      "id": "copy_button_background",
      "label": "Background",
      "default": "#1f2937"
    },
    {
      "type": "color",
      "id": "copy_button_hover_background",
      "label": "Hover background",
      "default": "#111827"
    },
    {
      "type": "color",
      "id": "copy_button_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "copy_button_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 6
    },
    {
      "type": "color",
      "id": "success_color",
      "label": "Success color",
      "default": "#10b981"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "checkbox",
      "id": "show_arrows",
      "label": "Show arrows",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_dots",
      "label": "Show dots",
      "default": true
    },
    {
      "type": "color",
      "id": "arrow_background",
      "label": "Arrow background",
      "default": "#f3f4f6"
    },
    {
      "type": "color",
      "id": "arrow_hover_background",
      "label": "Arrow hover background",
      "default": "#e5e7eb"
    },
    {
      "type": "color",
      "id": "arrow_color",
      "label": "Arrow color",
      "default": "#1f2937"
    },
    {
      "type": "color",
      "id": "dot_color",
      "label": "Dot color",
      "default": "#1f2937"
    },
    {
      "type": "header",
      "content": "Offer 1"
    },
    {
      "type": "checkbox",
      "id": "offer_1_enabled",
      "label": "Enable offer 1",
      "default": true
    },
    {
      "type": "inline_richtext",
      "id": "offer_1_title",
      "label": "Title",
      "default": "Enjoy ৳ 100 off on orders ৳ 1500+"
    },
    {
      "type": "inline_richtext",
      "id": "offer_1_description",
      "label": "Description",
      "default": "Get instant discount on your first order"
    },
    {
      "type": "text",
      "id": "offer_1_code",
      "label": "Code",
      "default": "INSTANT100"
    },
    {
      "type": "header",
      "content": "Offer 2"
    },
    {
      "type": "checkbox",
      "id": "offer_2_enabled",
      "label": "Enable offer 2",
      "default": true
    },
    {
      "type": "inline_richtext",
      "id": "offer_2_title",
      "label": "Title",
      "default": "Free shipping on orders ৳ 2000+"
    },
    {
      "type": "inline_richtext",
      "id": "offer_2_description",
      "label": "Description",
      "default": "No delivery charges for orders above ৳ 2000"
    },
    {
      "type": "text",
      "id": "offer_2_code",
      "label": "Code",
      "default": "FREESHIP"
    },
    {
      "type": "header",
      "content": "Offer 3"
    },
    {
      "type": "checkbox",
      "id": "offer_3_enabled",
      "label": "Enable offer 3",
      "default": true
    },
    {
      "type": "inline_richtext",
      "id": "offer_3_title",
      "label": "Title",
      "default": "Save ৳ 200 on orders ৳ 3000+"
    },
    {
      "type": "inline_richtext",
      "id": "offer_3_description",
      "label": "Description",
      "default": "Big savings on larger orders"
    },
    {
      "type": "text",
      "id": "offer_3_code",
      "label": "Code",
      "default": "SAVE200"
    },
    {
      "type": "header",
      "content": "Offer 4"
    },
    {
      "type": "checkbox",
      "id": "offer_4_enabled",
      "label": "Enable offer 4",
      "default": false
    },
    {
      "type": "inline_richtext",
      "id": "offer_4_title",
      "label": "Title"
    },
    {
      "type": "inline_richtext",
      "id": "offer_4_description",
      "label": "Description"
    },
    {
      "type": "text",
      "id": "offer_4_code",
      "label": "Code"
    },
    {
      "type": "header",
      "content": "Offer 5"
    },
    {
      "type": "checkbox",
      "id": "offer_5_enabled",
      "label": "Enable offer 5",
      "default": false
    },
    {
      "type": "inline_richtext",
      "id": "offer_5_title",
      "label": "Title"
    },
    {
      "type": "inline_richtext",
      "id": "offer_5_description",
      "label": "Description"
    },
    {
      "type": "text",
      "id": "offer_5_code",
      "label": "Code"
    }
  ],
  "presets": [
    {
      "name": "Available offers"
    }
  ]
}
{% endschema %}