{% doc %}
  @prompt
     Design a clean e-commerce product grid with a 2×2 layout. Each card has a white background, thin black borders, and centered product images. Add a red 'HOLIDAY SPECIAL' ribbon on top cards. Show product name, subtitle, price aligned right, and a small plus icon for quick add. Minimal, editorial sneaker-store style., vendor name should't be visible also in desktop version there should be 4 products per row and product image should fit in both mobile and desktop version, in desktop version there shouldn't be any gap on left and right side., in both mobile and desktop the product image isn't fully fit the product image container , add product title and price font picker and size adjustment. also add countdown ribbon, on mobile version there is a gap on left side of product title and price reduce that gap a little bit on both left and right side ,  Design a clean e-commerce product grid with a 2×2 layout. Each card has a white background, thin black borders, and centered product images. Add a red 'HOLIDAY SPECIAL' ribbon on top cards. Show product name, subtitle, price aligned right, and a small plus icon for quick add. Minimal, editorial sneaker-store style., vendor name should't be visible also in desktop version there should be 4 products per row and product image should fit in both mobile and desktop version, in desktop version there shouldn't be any gap on left and right side., in both mobile and desktop the product image isn't fully fit the product image container , add product title and price font picker and size adjustment. also add countdown ribbon, on mobile version there is a gap on left side of product title and price reduce that gap a little bit on both left and right side , i want a little bit padding on top and bottom and increase the gap on left and light side a little bit on mobile version, i want a little more gap on left and right side on mobile version. same should be for desktop version too, i want a little bit more gap on left and right side on desktop version , i want a little bit more gap on left and right side on desktop version 
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-product-grid-{{ ai_gen_id }} {
    width: 100%;
    display: block;
    padding: {{ block.settings.mobile_vertical_padding }}px 0;
  }

  @media screen and (min-width: 750px) {
    .ai-product-grid-{{ ai_gen_id }} {
      padding: {{ block.settings.desktop_vertical_padding }}px 0;
    }
  }

  .ai-product-grid__container-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: {{ block.settings.mobile_gap }}px;
    padding: 0 {{ block.settings.mobile_horizontal_padding }}px;
  }

  @media screen and (min-width: 750px) {
    .ai-product-grid__container-{{ ai_gen_id }} {
      grid-template-columns: repeat({{ block.settings.desktop_columns }}, 1fr);
      gap: {{ block.settings.desktop_gap }}px;
      padding: 0 {{ block.settings.desktop_horizontal_padding }}px;
    }
  }

  .ai-product-card-{{ ai_gen_id }} {
    background: {{ block.settings.card_background }};
    border: {{ block.settings.border_width }}px solid {{ block.settings.border_color }};
    position: relative;
    display: flex;
    flex-direction: column;
  }

  .ai-product-card__image-wrapper-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    padding-bottom: 100%;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #fafafa;
  }

  .ai-product-card__image-{{ ai_gen_id }} {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: {{ block.settings.image_width }}%;
    height: {{ block.settings.image_height }}%;
    object-fit: contain;
  }

  .ai-product-card__placeholder-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-product-card__placeholder-{{ ai_gen_id }} svg {
    width: 60%;
    height: 60%;
    opacity: 0.3;
  }

  .ai-product-card__ribbon-{{ ai_gen_id }} {
    position: absolute;
    top: {{ block.settings.ribbon_top_position }}px;
    left: 0;
    background: {{ block.settings.ribbon_background }};
    color: {{ block.settings.ribbon_text_color }};
    padding: {{ block.settings.ribbon_padding_vertical }}px {{ block.settings.ribbon_padding_horizontal }}px;
    font-size: {{ block.settings.ribbon_font_size }}px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    z-index: 2;
    display: flex;
    align-items: center;
    gap: 8px;
    white-space: nowrap;
  }

  .ai-product-card__countdown-{{ ai_gen_id }} {
    font-size: {{ block.settings.countdown_font_size }}px;
    font-weight: 600;
    letter-spacing: 0.5px;
  }

  .ai-product-card__info-{{ ai_gen_id }} {
    padding: {{ block.settings.card_padding_mobile }}px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex-grow: 1;
  }

  @media screen and (min-width: 750px) {
    .ai-product-card__info-{{ ai_gen_id }} {
      padding: {{ block.settings.card_padding_desktop }}px;
    }
  }

  .ai-product-card__title-{{ ai_gen_id }} {
    font-family: {{ block.settings.title_font.family }}, {{ block.settings.title_font.fallback_families }};
    font-weight: {{ block.settings.title_font.weight }};
    font-style: {{ block.settings.title_font.style }};
    font-size: {{ block.settings.title_font_size_mobile }}px;
    line-height: 1.3;
    margin: 0;
    color: {{ block.settings.title_color }};
  }

  @media screen and (min-width: 750px) {
    .ai-product-card__title-{{ ai_gen_id }} {
      font-size: {{ block.settings.title_font_size_desktop }}px;
    }
  }

  .ai-product-card__subtitle-{{ ai_gen_id }} {
    font-size: {{ block.settings.subtitle_font_size }}px;
    color: {{ block.settings.subtitle_color }};
    margin: 0;
  }

  .ai-product-card__footer-{{ ai_gen_id }} {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: auto;
    padding-top: 8px;
  }

  .ai-product-card__price-{{ ai_gen_id }} {
    font-family: {{ block.settings.price_font.family }}, {{ block.settings.price_font.fallback_families }};
    font-weight: {{ block.settings.price_font.weight }};
    font-style: {{ block.settings.price_font.style }};
    font-size: {{ block.settings.price_font_size_mobile }}px;
    color: {{ block.settings.price_color }};
    font-weight: 600;
  }

  @media screen and (min-width: 750px) {
    .ai-product-card__price-{{ ai_gen_id }} {
      font-size: {{ block.settings.price_font_size_desktop }}px;
    }
  }

  .ai-product-card__add-button-{{ ai_gen_id }} {
    width: {{ block.settings.add_button_size }}px;
    height: {{ block.settings.add_button_size }}px;
    border-radius: 50%;
    background: {{ block.settings.add_button_background }};
    border: 1px solid {{ block.settings.add_button_border }};
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
  }

  .ai-product-card__add-button-{{ ai_gen_id }}:hover {
    background: {{ block.settings.add_button_hover_background }};
    transform: scale(1.1);
  }

  .ai-product-card__add-button-{{ ai_gen_id }}:hover .ai-product-card__add-icon-{{ ai_gen_id }} {
    stroke: {{ block.settings.add_button_hover_icon_color }};
  }

  .ai-product-card__add-icon-{{ ai_gen_id }} {
    width: 14px;
    height: 14px;
    stroke: {{ block.settings.add_button_icon_color }};
    stroke-width: 2;
    transition: stroke 0.2s ease;
  }

  .ai-product-card__link-{{ ai_gen_id }} {
    text-decoration: none;
    color: inherit;
    display: block;
  }
{% endstyle %}

<product-grid-{{ ai_gen_id }} class="ai-product-grid-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-product-grid__container-{{ ai_gen_id }}">
    {% if block.settings.product_list != blank %}
      {% for product in block.settings.product_list limit: block.settings.products_to_show %}
        <div class="ai-product-card-{{ ai_gen_id }}">
          <a href="{{ product.url }}" class="ai-product-card__link-{{ ai_gen_id }}">
            <div class="ai-product-card__image-wrapper-{{ ai_gen_id }}">
              {% if product.featured_image %}
                <img
                  src="{{ product.featured_image | image_url: width: 800 }}"
                  alt="{{ product.featured_image.alt | escape }}"
                  class="ai-product-card__image-{{ ai_gen_id }}"
                  loading="lazy"
                  width="800"
                  height="800"
                >
              {% else %}
                <div class="ai-product-card__placeholder-{{ ai_gen_id }}">
                  {{ 'product-1' | placeholder_svg_tag }}
                </div>
              {% endif %}

              {% if block.settings.show_ribbon and forloop.index <= block.settings.ribbon_card_count %}
                <div class="ai-product-card__ribbon-{{ ai_gen_id }}">
                  <span>{{ block.settings.ribbon_text }}</span>
                  {% if block.settings.show_countdown %}
                    <span class="ai-product-card__countdown-{{ ai_gen_id }}" data-countdown-end="{{ block.settings.countdown_end_time }}">
                      00:00:00
                    </span>
                  {% endif %}
                </div>
              {% endif %}
            </div>

            <div class="ai-product-card__info-{{ ai_gen_id }}">
              <h3 class="ai-product-card__title-{{ ai_gen_id }}">{{ product.title }}</h3>
              
              {% if block.settings.show_subtitle and product.metafields.custom.subtitle != blank %}
                <p class="ai-product-card__subtitle-{{ ai_gen_id }}">{{ product.metafields.custom.subtitle }}</p>
              {% endif %}

              <div class="ai-product-card__footer-{{ ai_gen_id }}">
                <span class="ai-product-card__price-{{ ai_gen_id }}">
                  {{ product.price | money }}
                </span>
                
                <button
                  class="ai-product-card__add-button-{{ ai_gen_id }}"
                  aria-label="Add {{ product.title }} to cart"
                  data-product-id="{{ product.id }}"
                  data-variant-id="{{ product.selected_or_first_available_variant.id }}"
                >
                  <svg class="ai-product-card__add-icon-{{ ai_gen_id }}" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <line x1="12" y1="5" x2="12" y2="19" stroke-linecap="round"/>
                    <line x1="5" y1="12" x2="19" y2="12" stroke-linecap="round"/>
                  </svg>
                </button>
              </div>
            </div>
          </a>
        </div>
      {% endfor %}
    {% else %}
      {% for i in (1..8) %}
        <div class="ai-product-card-{{ ai_gen_id }}">
          <div class="ai-product-card__image-wrapper-{{ ai_gen_id }}">
            <div class="ai-product-card__placeholder-{{ ai_gen_id }}">
              {{ 'product-1' | placeholder_svg_tag }}
            </div>
            
            {% if block.settings.show_ribbon and i <= block.settings.ribbon_card_count %}
              <div class="ai-product-card__ribbon-{{ ai_gen_id }}">
                <span>{{ block.settings.ribbon_text }}</span>
                {% if block.settings.show_countdown %}
                  <span class="ai-product-card__countdown-{{ ai_gen_id }}">00:00:00</span>
                {% endif %}
              </div>
            {% endif %}
          </div>

          <div class="ai-product-card__info-{{ ai_gen_id }}">
            <h3 class="ai-product-card__title-{{ ai_gen_id }}">Product title</h3>
            <p class="ai-product-card__subtitle-{{ ai_gen_id }}">Product subtitle</p>

            <div class="ai-product-card__footer-{{ ai_gen_id }}">
              <span class="ai-product-card__price-{{ ai_gen_id }}">৳0.00</span>
              
              <button class="ai-product-card__add-button-{{ ai_gen_id }}" aria-label="Add to cart">
                <svg class="ai-product-card__add-icon-{{ ai_gen_id }}" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <line x1="12" y1="5" x2="12" y2="19" stroke-linecap="round"/>
                  <line x1="5" y1="12" x2="19" y2="12" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      {% endfor %}
    {% endif %}
  </div>
</product-grid-{{ ai_gen_id }}>

<script>
  (function() {
    class ProductGrid{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.setupAddToCart();
        {% if block.settings.show_countdown %}
          this.setupCountdown();
        {% endif %}
      }

      setupAddToCart() {
        const buttons = this.querySelectorAll('.ai-product-card__add-button-{{ ai_gen_id }}');
        
        buttons.forEach(button => {
          button.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            
            const variantId = button.dataset.variantId;
            if (!variantId) return;

            const formData = {
              items: [{
                id: variantId,
                quantity: 1
              }]
            };

            fetch('/cart/add.js', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
              window.location.href = '/cart';
            })
            .catch(error => {
              console.error('Error:', error);
            });
          });
        });
      }

      setupCountdown() {
        const countdownElements = this.querySelectorAll('.ai-product-card__countdown-{{ ai_gen_id }}');
        
        countdownElements.forEach(element => {
          const endTime = element.dataset.countdownEnd;
          if (!endTime) return;

          const updateCountdown = () => {
            const now = new Date().getTime();
            const end = new Date(endTime).getTime();
            const distance = end - now;

            if (distance < 0) {
              element.textContent = '00:00:00';
              return;
            }

            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            element.textContent = 
              String(hours).padStart(2, '0') + ':' +
              String(minutes).padStart(2, '0') + ':' +
              String(seconds).padStart(2, '0');
          };

          updateCountdown();
          setInterval(updateCountdown, 1000);
        });
      }
    }

    customElements.define('product-grid-{{ ai_gen_id }}', ProductGrid{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Product grid",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Products"
    },
    {
      "type": "product_list",
      "id": "product_list",
      "label": "Products",
      "limit": 12
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "label": "Products to show",
      "default": 8
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "desktop_columns",
      "min": 2,
      "max": 6,
      "step": 1,
      "label": "Desktop columns",
      "default": 4
    },
    {
      "type": "range",
      "id": "desktop_gap",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Desktop gap",
      "default": 16
    },
    {
      "type": "range",
      "id": "desktop_horizontal_padding",
      "min": 0,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Desktop horizontal padding",
      "default": 28
    },
    {
      "type": "range",
      "id": "mobile_gap",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Mobile gap",
      "default": 12
    },
    {
      "type": "range",
      "id": "mobile_horizontal_padding",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Mobile horizontal padding",
      "default": 16
    },
    {
      "type": "range",
      "id": "mobile_vertical_padding",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Mobile vertical padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "desktop_vertical_padding",
      "min": 0,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Desktop vertical padding",
      "default": 32
    },
    {
      "type": "header",
      "content": "Card style"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 1,
      "max": 4,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "range",
      "id": "card_padding_mobile",
      "min": 4,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Card padding (mobile)",
      "default": 10
    },
    {
      "type": "range",
      "id": "card_padding_desktop",
      "min": 8,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Card padding (desktop)",
      "default": 16
    },
    {
      "type": "header",
      "content": "Product image"
    },
    {
      "type": "range",
      "id": "image_width",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Image width",
      "default": 90
    },
    {
      "type": "range",
      "id": "image_height",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Image height",
      "default": 90
    },
    {
      "type": "header",
      "content": "Ribbon"
    },
    {
      "type": "checkbox",
      "id": "show_ribbon",
      "label": "Show ribbon",
      "default": true
    },
    {
      "type": "range",
      "id": "ribbon_card_count",
      "min": 1,
      "max": 12,
      "step": 1,
      "label": "Show ribbon on first X cards",
      "default": 4
    },
    {
      "type": "text",
      "id": "ribbon_text",
      "label": "Ribbon text",
      "default": "HOLIDAY SPECIAL"
    },
    {
      "type": "color",
      "id": "ribbon_background",
      "label": "Background",
      "default": "#ff0000"
    },
    {
      "type": "color",
      "id": "ribbon_text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "ribbon_font_size",
      "min": 8,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Font size",
      "default": 10
    },
    {
      "type": "range",
      "id": "ribbon_padding_vertical",
      "min": 2,
      "max": 12,
      "step": 1,
      "unit": "px",
      "label": "Vertical padding",
      "default": 4
    },
    {
      "type": "range",
      "id": "ribbon_padding_horizontal",
      "min": 4,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Horizontal padding",
      "default": 8
    },
    {
      "type": "range",
      "id": "ribbon_top_position",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Top position",
      "default": 12
    },
    {
      "type": "header",
      "content": "Countdown timer"
    },
    {
      "type": "checkbox",
      "id": "show_countdown",
      "label": "Show countdown on ribbon",
      "default": true
    },
    {
      "type": "text",
      "id": "countdown_end_time",
      "label": "End date and time",
      "info": "Format: YYYY-MM-DD HH:MM:SS (e.g., 2025-12-31 23:59:59)",
      "default": "2025-12-31 23:59:59"
    },
    {
      "type": "range",
      "id": "countdown_font_size",
      "min": 8,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Font size",
      "default": 10
    },
    {
      "type": "header",
      "content": "Product title"
    },
    {
      "type": "font_picker",
      "id": "title_font",
      "label": "Font",
      "default": "helvetica_n4"
    },
    {
      "type": "range",
      "id": "title_font_size_mobile",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Font size (mobile)",
      "default": 13
    },
    {
      "type": "range",
      "id": "title_font_size_desktop",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Font size (desktop)",
      "default": 14
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Product subtitle"
    },
    {
      "type": "checkbox",
      "id": "show_subtitle",
      "label": "Show subtitle",
      "info": "Uses product metafield: custom.subtitle",
      "default": true
    },
    {
      "type": "range",
      "id": "subtitle_font_size",
      "min": 8,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Font size",
      "default": 11
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Color",
      "default": "#666666"
    },
    {
      "type": "header",
      "content": "Product price"
    },
    {
      "type": "font_picker",
      "id": "price_font",
      "label": "Font",
      "default": "helvetica_n4"
    },
    {
      "type": "range",
      "id": "price_font_size_mobile",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Font size (mobile)",
      "default": 13
    },
    {
      "type": "range",
      "id": "price_font_size_desktop",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Font size (desktop)",
      "default": 14
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Add button"
    },
    {
      "type": "range",
      "id": "add_button_size",
      "min": 20,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Button size",
      "default": 28
    },
    {
      "type": "color",
      "id": "add_button_background",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "add_button_hover_background",
      "label": "Hover background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "add_button_border",
      "label": "Border color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "add_button_icon_color",
      "label": "Icon color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "add_button_hover_icon_color",
      "label": "Hover icon color",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Product grid"
    }
  ]
}
{% endschema %}
