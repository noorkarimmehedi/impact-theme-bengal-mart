{% doc %}
  @prompt
    generate me a fashion brand category section where 3 categories in every row in mobile version and appealing in desktop version , should have the option for Category custom image adding , in desktop version it should be slider with arrow key . don't change anything on mobile version. for the Border and shadow i want this: Border
    Border width
    
    1
    Border color
    
    #E0E0E0
    Hover border color
    
    #CCCCCC
    Border radius
    
    8
    Shadow
    Horizontal offset
    
    0
    Vertical offset
    
    4
    Blur radius
    
    8
    Shadow opacity
    
    0
    , i don't want category Description and category title should be option for overlay text , option for collection should be added fro shopify, the default collection image isn't showing also title is not added please add titile option. i should have the option to hide unused collections, there is a black overlay background on overlay collection name text. remove that background, the collection default image isn't showing. in desktop version there should be arrow on left and right side to see collections , i barely see the Overlay text. fix this . also add top and bottom padding should be adjustable , gap between collections and size of the collection image should be adjustable
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-category-section-{{ ai_gen_id }} {
    padding-top: {{ block.settings.padding_top }}px;
    padding-bottom: {{ block.settings.padding_bottom }}px;
  }

  .ai-category-container-{{ ai_gen_id }} {
    max-width: 100%;
    margin: 0 auto;
    padding: 0 20px;
  }

  .ai-category-title-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 30px;
    font-size: 32px;
    font-weight: 600;
  }

  .ai-category-grid-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: {{ block.settings.gap_between_items }}px;
  }

  .ai-category-item-{{ ai_gen_id }} {
    position: relative;
    overflow: hidden;
    border-radius: {{ block.settings.border_radius }}px;
    border: {{ block.settings.border_width }}px solid {{ block.settings.border_color }};
    transition: all 0.3s ease;
    box-shadow: {{ block.settings.shadow_horizontal }}px {{ block.settings.shadow_vertical }}px {{ block.settings.shadow_blur }}px rgba(0, 0, 0, {{ block.settings.shadow_opacity | divided_by: 100.0 }});
    cursor: pointer;
  }

  .ai-category-item-{{ ai_gen_id }}:hover {
    border-color: {{ block.settings.hover_border_color }};
  }

  .ai-category-link-{{ ai_gen_id }} {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .ai-category-image-wrapper-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    padding-bottom: {{ block.settings.image_aspect_ratio }}%;
    overflow: hidden;
  }

  .ai-category-image-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-category-placeholder-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-category-placeholder-{{ ai_gen_id }} svg {
    width: 60%;
    height: 60%;
    opacity: 0.3;
  }

  .ai-category-overlay-{{ ai_gen_id }} {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 15px;
    text-align: center;
  }

  .ai-category-name-{{ ai_gen_id }} {
    color: {{ block.settings.overlay_text_color }};
    font-size: {{ block.settings.overlay_text_size }}px;
    font-weight: 600;
    margin: 0;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  }

  .ai-category-desktop-slider-{{ ai_gen_id }} {
    display: none;
  }

  @media screen and (min-width: 750px) {
    .ai-category-grid-{{ ai_gen_id }} {
      display: none;
    }

    .ai-category-desktop-slider-{{ ai_gen_id }} {
      display: block;
      position: relative;
    }

    .ai-category-slider-wrapper-{{ ai_gen_id }} {
      overflow: hidden;
      position: relative;
    }

    .ai-category-slider-track-{{ ai_gen_id }} {
      display: flex;
      gap: {{ block.settings.gap_between_items }}px;
      transition: transform 0.3s ease;
    }

    .ai-category-slide-{{ ai_gen_id }} {
      flex: 0 0 calc((100% - ({{ block.settings.desktop_items_per_view | minus: 1 }} * {{ block.settings.gap_between_items }}px)) / {{ block.settings.desktop_items_per_view }});
      min-width: 0;
    }

    .ai-category-arrow-{{ ai_gen_id }} {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background-color: {{ block.settings.arrow_background }};
      color: {{ block.settings.arrow_color }};
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .ai-category-arrow-{{ ai_gen_id }}:hover {
      background-color: {{ block.settings.arrow_hover_background }};
      transform: translateY(-50%) scale(1.1);
    }

    .ai-category-arrow-{{ ai_gen_id }}:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .ai-category-arrow-{{ ai_gen_id }}:disabled:hover {
      transform: translateY(-50%) scale(1);
    }

    .ai-category-arrow-prev-{{ ai_gen_id }} {
      left: -25px;
    }

    .ai-category-arrow-next-{{ ai_gen_id }} {
      right: -25px;
    }

    .ai-category-arrow-{{ ai_gen_id }} svg {
      width: 24px;
      height: 24px;
    }
  }
{% endstyle %}

<category-slider-{{ ai_gen_id }} class="ai-category-section-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-category-container-{{ ai_gen_id }}">
    {% if block.settings.section_title != blank %}
      <h2 class="ai-category-title-{{ ai_gen_id }}">{{ block.settings.section_title }}</h2>
    {% endif %}

    <div class="ai-category-grid-{{ ai_gen_id }}">
      {% for i in (1..12) %}
        {% liquid
          assign collection_key = 'collection_' | append: i
          assign image_key = 'custom_image_' | append: i
          assign hide_key = 'hide_collection_' | append: i
          
          assign collection = block.settings[collection_key]
          assign custom_image = block.settings[image_key]
          assign hide_collection = block.settings[hide_key]
        %}

        {% unless hide_collection %}
          {% if collection != blank or custom_image != blank %}
            <div class="ai-category-item-{{ ai_gen_id }}">
              <a href="{% if collection != blank %}{{ collection.url }}{% else %}#{% endif %}" class="ai-category-link-{{ ai_gen_id }}">
                <div class="ai-category-image-wrapper-{{ ai_gen_id }}">
                  {% if custom_image != blank %}
                    <img
                      src="{{ custom_image | image_url: width: 800 }}"
                      alt="{{ collection.title | default: 'Category' | escape }}"
                      class="ai-category-image-{{ ai_gen_id }}"
                      loading="lazy"
                      width="800"
                      height="800"
                    >
                  {% elsif collection != blank and collection.image != blank %}
                    <img
                      src="{{ collection.image | image_url: width: 800 }}"
                      alt="{{ collection.title | escape }}"
                      class="ai-category-image-{{ ai_gen_id }}"
                      loading="lazy"
                      width="800"
                      height="800"
                    >
                  {% else %}
                    <div class="ai-category-placeholder-{{ ai_gen_id }}">
                      {{ 'collection-1' | placeholder_svg_tag }}
                    </div>
                  {% endif %}

                  {% if block.settings.show_overlay_text %}
                    <div class="ai-category-overlay-{{ ai_gen_id }}">
                      <h3 class="ai-category-name-{{ ai_gen_id }}">
                        {% if collection != blank %}
                          {{ collection.title }}
                        {% else %}
                          Category {{ i }}
                        {% endif %}
                      </h3>
                    </div>
                  {% endif %}
                </div>
              </a>
            </div>
          {% endif %}
        {% endunless %}
      {% endfor %}
    </div>

    <div class="ai-category-desktop-slider-{{ ai_gen_id }}">
      <button class="ai-category-arrow-{{ ai_gen_id }} ai-category-arrow-prev-{{ ai_gen_id }}" aria-label="Previous">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <div class="ai-category-slider-wrapper-{{ ai_gen_id }}">
        <div class="ai-category-slider-track-{{ ai_gen_id }}">
          {% for i in (1..12) %}
            {% liquid
              assign collection_key = 'collection_' | append: i
              assign image_key = 'custom_image_' | append: i
              assign hide_key = 'hide_collection_' | append: i
              
              assign collection = block.settings[collection_key]
              assign custom_image = block.settings[image_key]
              assign hide_collection = block.settings[hide_key]
            %}

            {% unless hide_collection %}
              {% if collection != blank or custom_image != blank %}
                <div class="ai-category-slide-{{ ai_gen_id }}">
                  <div class="ai-category-item-{{ ai_gen_id }}">
                    <a href="{% if collection != blank %}{{ collection.url }}{% else %}#{% endif %}" class="ai-category-link-{{ ai_gen_id }}">
                      <div class="ai-category-image-wrapper-{{ ai_gen_id }}">
                        {% if custom_image != blank %}
                          <img
                            src="{{ custom_image | image_url: width: 800 }}"
                            alt="{{ collection.title | default: 'Category' | escape }}"
                            class="ai-category-image-{{ ai_gen_id }}"
                            loading="lazy"
                            width="800"
                            height="800"
                          >
                        {% elsif collection != blank and collection.image != blank %}
                          <img
                            src="{{ collection.image | image_url: width: 800 }}"
                            alt="{{ collection.title | escape }}"
                            class="ai-category-image-{{ ai_gen_id }}"
                            loading="lazy"
                            width="800"
                            height="800"
                          >
                        {% else %}
                          <div class="ai-category-placeholder-{{ ai_gen_id }}">
                            {{ 'collection-1' | placeholder_svg_tag }}
                          </div>
                        {% endif %}

                        {% if block.settings.show_overlay_text %}
                          <div class="ai-category-overlay-{{ ai_gen_id }}">
                            <h3 class="ai-category-name-{{ ai_gen_id }}">
                              {% if collection != blank %}
                                {{ collection.title }}
                              {% else %}
                                Category {{ i }}
                              {% endif %}
                            </h3>
                          </div>
                        {% endif %}
                      </div>
                    </a>
                  </div>
                </div>
              {% endif %}
            {% endunless %}
          {% endfor %}
        </div>
      </div>

      <button class="ai-category-arrow-{{ ai_gen_id }} ai-category-arrow-next-{{ ai_gen_id }}" aria-label="Next">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>
  </div>
</category-slider-{{ ai_gen_id }}>

<script>
  (function() {
    class CategorySlider{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.currentIndex = 0;
        this.itemsPerView = {{ block.settings.desktop_items_per_view }};
      }

      connectedCallback() {
        this.track = this.querySelector('.ai-category-slider-track-{{ ai_gen_id }}');
        this.slides = this.querySelectorAll('.ai-category-slide-{{ ai_gen_id }}');
        this.prevButton = this.querySelector('.ai-category-arrow-prev-{{ ai_gen_id }}');
        this.nextButton = this.querySelector('.ai-category-arrow-next-{{ ai_gen_id }}');

        if (!this.track || this.slides.length === 0) return;

        this.totalSlides = this.slides.length;
        this.maxIndex = Math.max(0, this.totalSlides - this.itemsPerView);

        this.prevButton.addEventListener('click', () => this.prev());
        this.nextButton.addEventListener('click', () => this.next());

        this.updateButtons();
      }

      prev() {
        if (this.currentIndex > 0) {
          this.currentIndex--;
          this.updateSlider();
        }
      }

      next() {
        if (this.currentIndex < this.maxIndex) {
          this.currentIndex++;
          this.updateSlider();
        }
      }

      updateSlider() {
        const slideWidth = this.slides[0].offsetWidth;
        const gap = {{ block.settings.gap_between_items }};
        const offset = -(this.currentIndex * (slideWidth + gap));
        this.track.style.transform = `translateX(${offset}px)`;
        this.updateButtons();
      }

      updateButtons() {
        this.prevButton.disabled = this.currentIndex === 0;
        this.nextButton.disabled = this.currentIndex >= this.maxIndex;
      }
    }

    customElements.define('category-slider-{{ ai_gen_id }}', CategorySlider{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Fashion category section",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Section"
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section title",
      "default": "Shop by Category"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Top padding",
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Bottom padding",
      "default": 50
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "gap_between_items",
      "min": 5,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Gap between items",
      "default": 15
    },
    {
      "type": "range",
      "id": "image_aspect_ratio",
      "min": 50,
      "max": 150,
      "step": 5,
      "unit": "%",
      "label": "Image height",
      "default": 100
    },
    {
      "type": "range",
      "id": "desktop_items_per_view",
      "min": 2,
      "max": 6,
      "step": 1,
      "label": "Items per view (desktop)",
      "default": 4
    },
    {
      "type": "header",
      "content": "Border"
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#E0E0E0"
    },
    {
      "type": "color",
      "id": "hover_border_color",
      "label": "Hover border color",
      "default": "#CCCCCC"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Shadow"
    },
    {
      "type": "range",
      "id": "shadow_horizontal",
      "min": -20,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Horizontal offset",
      "default": 0
    },
    {
      "type": "range",
      "id": "shadow_vertical",
      "min": -20,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Vertical offset",
      "default": 4
    },
    {
      "type": "range",
      "id": "shadow_blur",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Blur radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "shadow_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Shadow opacity",
      "default": 0
    },
    {
      "type": "header",
      "content": "Overlay text"
    },
    {
      "type": "checkbox",
      "id": "show_overlay_text",
      "label": "Show overlay text",
      "default": true
    },
    {
      "type": "color",
      "id": "overlay_text_color",
      "label": "Text color",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "overlay_text_size",
      "min": 12,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Text size",
      "default": 16
    },
    {
      "type": "header",
      "content": "Desktop slider arrows"
    },
    {
      "type": "color",
      "id": "arrow_background",
      "label": "Arrow background",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "arrow_hover_background",
      "label": "Arrow hover background",
      "default": "#F0F0F0"
    },
    {
      "type": "color",
      "id": "arrow_color",
      "label": "Arrow color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Collection 1"
    },
    {
      "type": "collection",
      "id": "collection_1",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_1",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_1",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 2"
    },
    {
      "type": "collection",
      "id": "collection_2",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_2",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_2",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 3"
    },
    {
      "type": "collection",
      "id": "collection_3",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_3",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_3",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 4"
    },
    {
      "type": "collection",
      "id": "collection_4",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_4",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_4",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 5"
    },
    {
      "type": "collection",
      "id": "collection_5",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_5",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_5",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 6"
    },
    {
      "type": "collection",
      "id": "collection_6",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_6",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_6",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 7"
    },
    {
      "type": "collection",
      "id": "collection_7",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_7",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_7",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 8"
    },
    {
      "type": "collection",
      "id": "collection_8",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_8",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_8",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 9"
    },
    {
      "type": "collection",
      "id": "collection_9",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_9",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_9",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 10"
    },
    {
      "type": "collection",
      "id": "collection_10",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_10",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_10",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 11"
    },
    {
      "type": "collection",
      "id": "collection_11",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_11",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_11",
      "label": "Hide this collection",
      "default": false
    },
    {
      "type": "header",
      "content": "Collection 12"
    },
    {
      "type": "collection",
      "id": "collection_12",
      "label": "Collection"
    },
    {
      "type": "image_picker",
      "id": "custom_image_12",
      "label": "Custom image"
    },
    {
      "type": "checkbox",
      "id": "hide_collection_12",
      "label": "Hide this collection",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "Fashion category section"
    }
  ]
}
{% endschema %}
